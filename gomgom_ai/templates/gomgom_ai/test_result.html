{% load static %}

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>_랜덤밥상</title>
    <link rel="stylesheet" href="{% static 'css/randomfood.css' %}">
    <!--    <script src = "../javascript/elice.json" type="text/javascript"></script>-->
</head>
<body>
<div class="background">
    <div class="header">
        <h3>
            <a href="{% url 'main' %}">
                <img id="logo" src="{% static 'image/로고.png' %}" alt="logo">

                <span class="header_text">&nbsp;CLICK YOUR TASTE!</span>
            </a>
        </h3>
    </div>
    <!-- 로딩 애니메이션 -->
    <div id="loading" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(255,255,255,0.8); z-index: 9999; display: flex; align-items: center; justify-content: center;">
        <div class="spinner"></div>
    </div>

    <div class="container">
        <div class="main">
            <div class="heading2">
                <h2>당신에게 딱 맞는 음식은?</h2>
            </div>
            <div class="result">

                <img class="resultImg" src="{% static 'image/상반신 요리사 토끼.png' %}" alt="토끼">
             <div class="sideinfo">
                 <h1 class="selected-store">{{ result.store }}</h1>
                 <p class="selected-description">{{ result.description }}</p>
                 <a href="{% url 'main' %}"><button type="button" class="replayButton">다시하기</button></a>
                 <button class="othermenu" onclick="showAnotherRestaurant()">다른 결과 보기</button>
             </div>
            </div>
        </div>
    </div>
</div>

<!-- 아래 부분은 hidden으로 렌더링만 해놓고 JS에서 사용 -->
<script id="restaurantData" type="application/json">
    {{ restaurants|safe }}
</script>


<script>
    function showAnotherRestaurant() {
        const data = JSON.parse(document.getElementById("restaurantData").textContent);
        if (!Array.isArray(data) || data.length === 0) return;

        const random = data[Math.floor(Math.random() * data.length)];

        document.querySelector(".selected-store").textContent = random.name || "추천 없음";
        document.querySelector(".selected-description").textContent =
            (random.address || "주소 없음") + " / 평점: " + (random.review_avg || "없음");
    }

    // 페이지 로딩 시 애니메이션 보이기
    window.addEventListener('load', function () {
        document.getElementById('loading').style.display = 'none';
    });

    // 폼 전송 시 애니메이션 보이기 (필요 시)
    function showLoading() {
        document.getElementById('loading').style.display = 'flex';
    }
</script>

</body>
</html>

